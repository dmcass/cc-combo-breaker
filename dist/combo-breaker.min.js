!function(e){"use strict";angular.module("cc-combo-breaker",[]).directive("combobreaker",["$document",function(s){return{restrict:"E",replace:!0,template:'<div class=cc-combo-wrapper><div class=cc-input-wrapper><input type=text class=cc-combo-input autocomplete=off ng-model=ccSearch placeholder={{placeholder}}> <span class=button></span></div><div class=cc-suggestions><ul class=cc-list><li ng-repeat="item in list | filter: ccSearch | limitTo: ccLimit">{{item}}</li></ul></div></div>',scope:{list:"=",ngModel:"=",suggestionLimit:"@?",strict:"@?",placeholder:"@?"},link:function(t,i,c){var l=i.find("input[type=text]"),r=t.strict?"change":"input",o=i.find(".cc-list");isNaN(t.suggestionLimit)||Number(t.suggestionLimit)<=1?t.ccLimit=1/0:t.ccLimit=parseInt(t.suggestionLimit,10),s.on("click",function(s){var t,c=e(s.target);i.hasClass("focus")?(t=i.find("li"),c.is(t)&&(l.val(c.text()).trigger(r),t.removeClass("selected")),c.is(l)||(i.removeClass("focus"),t.removeClass("selected"))):c.closest(i).length&&(i.addClass("focus"),l.trigger("focus"),i.find(".selected").length||i.find("li").first().addClass("selected"))}),l.on("keydown",function(e){var s,c,o,n=i.find(".cc-suggestions"),a=n.height(),d=i.find(".selected");27===e.which?""===l.val()?(l.val("").trigger(r).trigger("blur"),i.removeClass("focus")):(i.removeClass("focus"),l.val(t.ngModel).trigger(r).trigger("blur")):9===e.which||13===e.which?d.length&&(e.preventDefault(),l.val(d.text()).trigger(r).trigger("blur"),i.removeClass("focus")):38===e.which?(s=i.find("li").first(),d.is(s)||(d=d.removeClass("selected").prev().addClass("selected"),c=d.position(),o=d.outerHeight(),c.top<n.scrollTop()&&n.scrollTop(c.top))):40===e.which&&(s=i.find("li").last(),d.is(s)||(d=d.removeClass("selected").next().addClass("selected"),c=d.position(),o=d.outerHeight(),c.top+o>n.scrollTop()+a&&n.scrollTop(c.top+o-n.height())))}),o.on("mouseenter","li",function(s){var t=e(s.target);t.addClass("selected").siblings().removeClass("selected")}),l.on("input",function(){var e=i.find("li.selected");e.removeClass("selected"),i.find("li").first().addClass("selected"),t.strict||t.$apply(function(){t.ngModel=t.ccSearch})}),t.strict&&(l.on("change",function(){""===l.val()?(i.find("li").first().addClass("selected"),t.$apply(function(){t.ngModel=t.ccSearch})):t.list.indexOf(l.val())>-1?t.$apply(function(){t.ngModel=t.ccSearch}):(i.addClass("cc-error"),l.val("").trigger("change"))}),i.on("animationend",function(s){e(s.target).is(l)&&i.hasClass("cc-error")&&i.removeClass("cc-error")}))},controller:["$scope",function(e){e.ccSearch=""}]}}])}(jQuery);